"use strict";(self.webpackChunklaifaxin_web=self.webpackChunklaifaxin_web||[]).push([[3131],{70683:function(ye,ce,n){var _e=n(35290),O=n.n(_e),me=n(30279),l=n.n(me),Ee=n(411),E=n.n(Ee),he=n(46686),M=n.n(he),j=n(31810),x=n(41318),V=n(16798),y=n(58110),f=n(77707),R=n(2800),Z=n(96498),_=n(46394),I=n(34833),ie=n(18799),D=n(1406),$=n(12209),T=n(85170),p=n(22196),q=n(74729),H=n(74637),se=n.n(H),te=n(8604),s=n(43010),ae={labelCol:{span:4},wrapperCol:{span:18}},B=function(g){var ne=g.visible,v=g.onCancel,P=g.actionReload,U=(0,T.useState)(!0),le=M()(U,2),F=le[0],fe=le[1],W=j.Z.useForm(),Ce=M()(W,1),k=Ce[0],ve=(0,T.useState)(!1),z=M()(ve,2),K=z[0],J=z[1],m=(0,T.useState)({}),oe=M()(m,2),L=oe[0],pe=oe[1],e=(0,p.useRequest)(q.k1,{manual:!0,onSuccess:function(S){if(!!S){pe(S);var X=S.success;X?(x.ZP.success("\u65B0\u589E\u8D26\u53F7\u6210\u529F"),k.resetFields(),v(),P()):x.ZP.error("\u65B0\u589E\u8D26\u53F7\u5931\u8D25")}}}),Pe=e.run,je=e.loading,de=(0,p.useRequest)(q.z$,{manual:!0}),Be=de.run,xe=function(){var Y=E()(O()().mark(function S(X){var N,C,Te,re,a,d,Se,be,Re,Oe,Ie,Le;return O()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(k){Q.next=2;break}return Q.abrupt("return");case 2:return k.submit(),Q.prev=3,Q.next=6,k.validateFields();case 6:return N=Q.sent,C=N.re_status,Te=N.re_error,re=N.se_status,a=N.se_error,d=N.re_sync,Se=N.re_time,be=void 0,d&&Se&&(be=se()(Se).valueOf()),Q.next=12,Pe(l()(l()({},N),{},{skip_error:X,se_proto:"smtp",re_status:C,re_error:Te,se_status:re,se_error:a,re_sync:d,re_time:be}));case 12:Q.next=19;break;case 14:Q.prev=14,Q.t0=Q.catch(3),Re=Q.t0.errorFields,Re&&(Oe=Re[0],Ie=Oe.errors,Le=Oe.name,Ie&&x.ZP.error(Ie.toString()),(Le.indexOf("re_server")>=0||Le.indexOf("se_server")>=0)&&fe(!1)),console.log("Failed:",Q.t0);case 19:case"end":return Q.stop()}},S,null,[[3,14]])}));return function(X){return Y.apply(this,arguments)}}(),ue=function(){var Y=E()(O()().mark(function S(){var X,N,C;return O()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,k.getFieldValue("mail_addr");case 2:if(X=re.sent,N=k.getFieldError("mail_addr"),!(!X||N.length)){re.next=6;break}return re.abrupt("return");case 6:return re.next=8,Be({email:X});case 8:C=re.sent,C&&k.setFieldsValue(l()(l()({},C),{},{mail_acc:X}));case 10:case"end":return re.stop()}},S)}));return function(){return Y.apply(this,arguments)}}(),Ze=function(S){J(S),S&&k.setFieldsValue({re_time:se()().subtract(30,"days")})},Fe=function(){if(!L||!L.check)return null;var S=L.re_status,X=L.re_error,N=L.se_status,C=L.se_error;return(0,s.jsxs)("div",{style:{maxWidth:720,overflow:"hidden"},children:[(0,s.jsxs)("div",{children:["\u6536\u4FE1\uFF1A",S?(0,s.jsx)("span",{style:{color:"green"},children:"\u6210\u529F"}):(0,s.jsx)("span",{style:{color:"red"},children:"\u5931\u8D25"}),S?null:(0,s.jsxs)("span",{style:{marginLeft:"12px"},children:["\u539F\u56E0\uFF1A",X]})]}),(0,s.jsxs)("div",{children:["\u53D1\u4FE1\uFF1A",N?(0,s.jsx)("span",{style:{color:"green"},children:"\u6210\u529F"}):(0,s.jsx)("span",{style:{color:"red"},children:"\u5931\u8D25"}),N?null:(0,s.jsxs)("span",{style:{marginLeft:"12px"},children:["\u539F\u56E0\uFF1A",C]})]})]})},We=function(){if(!L||!L.check)return(0,s.jsx)(V.ZP,{type:"primary",htmlType:"submit",loading:je,onClick:function(){return xe(!1)},children:"\u521B\u5EFA"});var S=L.re_status,X=L.se_status;return S&&X?(0,s.jsx)(V.ZP,{type:"primary",htmlType:"submit",loading:je,onClick:function(){return xe(!1)},children:"\u521B\u5EFA"}):S||X?(0,s.jsx)(V.ZP,{type:"primary",htmlType:"submit",loading:je,onClick:function(){return xe(!0)},danger:!0,ghost:!0,children:"\u7EE7\u7EED\u4FDD\u5B58"}):(0,s.jsx)(V.ZP,{type:"primary",htmlType:"submit",loading:je,onClick:function(){return xe(!1)},disabled:!0,children:"\u521B\u5EFA"})};return(0,s.jsx)(y.Z,{destroyOnClose:!0,title:"\u65B0\u5EFA\u90AE\u7BB1\u8D26\u53F7",open:ne,onCancel:function(){return v()},footer:null,width:640,children:(0,s.jsxs)(j.Z,l()(l()({},ae),{},{form:k,initialValues:{re_proto:"imap",re_ssl:!0,re_port:993,se_ssl:!0,se_port:465},onChange:function(){return pe({})},children:[(0,s.jsx)(j.Z.Item,{name:"re_proto",label:"\u6536\u4FE1\u534F\u8BAE",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u8D26\u53F7"}],hidden:F,children:(0,s.jsx)(f.ZP.Group,{children:(0,s.jsx)(f.ZP,{value:"imap",children:"IMAP"})})}),(0,s.jsx)(j.Z.Item,{name:"mail_addr",label:"\u90AE\u7BB1\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u8D26\u53F7"},{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740"}],hidden:!F,children:(0,s.jsx)(R.Z,{placeholder:"\u5982\uFF1Aname@domain.com",onBlur:function(){return ue()}})}),(0,s.jsx)(j.Z.Item,{name:"mail_acc",label:"\u90AE\u7BB1\u8D26\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u8D26\u53F7"}],hidden:F,children:(0,s.jsx)(R.Z,{placeholder:"\u5982\uFF1Aname@domain.com"})}),(0,s.jsx)(j.Z.Item,{name:"mail_pass",label:"\u90AE\u7BB1\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],hidden:!F,children:(0,s.jsx)(R.Z.Password,{placeholder:"******"})}),(0,s.jsx)(j.Z.Item,{name:"mail_name",label:"\u53D1\u4FE1\u540D\u79F0",hidden:!F,children:(0,s.jsx)(R.Z,{placeholder:"\u5982\uFF1A\u5F20\u4E09"})}),(0,s.jsxs)(Z.Z,{hidden:F,children:[(0,s.jsx)(_.Z,{span:14,children:(0,s.jsx)(j.Z.Item,{name:"re_server",label:"\u6536\u4FE1(IMAP)",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6536\u4FE1\u670D\u52A1\u5668\u5730\u5740"}],labelCol:{span:7},wrapperCol:{span:16},children:(0,s.jsx)(R.Z,{placeholder:"\u5982\uFF1Aimap.domain.com"})})}),(0,s.jsx)(_.Z,{span:3,children:(0,s.jsx)(j.Z.Item,{name:"re_ssl",label:"SSL",labelCol:{span:14},wrapperCol:{span:10},valuePropName:"checked",rules:[{required:!0,message:"\u5FC5\u586B"}],children:(0,s.jsx)(I.Z,{})})}),(0,s.jsx)(_.Z,{span:3,style:{marginLeft:12},children:(0,s.jsx)(j.Z.Item,{name:"re_port",label:"\u7AEF\u53E3",labelCol:{span:15},wrapperCol:{span:9},rules:[{required:!0,message:"\u5FC5\u586B"}],children:(0,s.jsx)(ie.Z,{controls:!1,style:{width:68}})})})]}),(0,s.jsxs)(Z.Z,{style:{marginBottom:0},hidden:F,children:[(0,s.jsx)(_.Z,{span:14,children:(0,s.jsx)(j.Z.Item,{name:"se_server",label:"\u53D1\u4FE1(SMTP)",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u4FE1\u670D\u52A1\u5668\u5730\u5740"}],labelCol:{span:7},wrapperCol:{span:16},children:(0,s.jsx)(R.Z,{placeholder:"\u5982\uFF1Asmtp.domain.com"})})}),(0,s.jsx)(_.Z,{span:3,children:(0,s.jsx)(j.Z.Item,{name:"se_ssl",label:"SSL",labelCol:{span:14},wrapperCol:{span:10},valuePropName:"checked",rules:[{required:!0,message:"\u5FC5\u586B"}],children:(0,s.jsx)(I.Z,{})})}),(0,s.jsx)(_.Z,{span:3,style:{marginLeft:12},children:(0,s.jsx)(j.Z.Item,{name:"se_port",label:"\u7AEF\u53E3",labelCol:{span:15},wrapperCol:{span:9},rules:[{required:!0,message:"\u5FC5\u586B"}],children:(0,s.jsx)(ie.Z,{controls:!1,style:{width:68}})})})]}),(0,s.jsxs)(Z.Z,{hidden:!F,children:[(0,s.jsx)(_.Z,{span:8,children:(0,s.jsx)(j.Z.Item,{name:"re_sync",label:"\u90AE\u4EF6\u540C\u6B65",labelCol:{span:12},wrapperCol:{span:12},valuePropName:"checked",children:(0,s.jsx)(I.Z,{onChange:function(S){return Ze(S.target.checked)}})})}),K?(0,s.jsxs)(_.Z,{span:16,children:["\u540C\u6B65",(0,s.jsx)(j.Z.Item,{name:"re_time",label:"",noStyle:!0,children:(0,s.jsx)(D.Z,{style:{marginLeft:"4px",marginRight:"4px"}})}),"\u4E4B\u540E\u90AE\u4EF6"]}):null]}),L.check?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(j.Z.Item,{label:!1,valuePropName:"checked",wrapperCol:{offset:4},rules:[{required:!0,message:"\u5FC5\u586B"}],children:[(0,s.jsx)(te.Z,{style:{color:"red"}})," \u6DFB\u52A0\u5931\u8D25"," ",(0,s.jsx)($.Z,{content:Fe,title:!1,children:(0,s.jsx)("a",{style:{color:"red"},children:"\u67E5\u770B\u8BE6\u60C5"})})]})}):null,(0,s.jsxs)("div",{style:{marginBottom:"24px",textAlign:"right"},children:[F?(0,s.jsx)(V.ZP,{style:{marginRight:"24px"},onClick:function(){return fe(!1)},children:"\u624B\u52A8\u8BBE\u7F6E"}):(0,s.jsx)(V.ZP,{style:{marginRight:"24px"},onClick:function(){return fe(!0)},children:"\u8FD4\u56DE"}),We()]})]}))})};ce.Z=B},61825:function(ye,ce,n){n.d(ce,{Z:function(){return H}});var _e=n(35290),O=n.n(_e),me=n(411),l=n.n(me),Ee=n(30279),E=n.n(Ee),he=n(46686),M=n.n(he),j=n(85170),x=n(31810),V=n(41318),y=n(64268),f=n(16798),R=n(2800),Z=n(58110),_={standardListForm:"standardListForm___D6tJX"},I=n(74729),ie=n(27429),D=n(1166),$=n(25106),T=n(43010),p={labelCol:{span:4},wrapperCol:{span:18}},q=function(te){var s=x.Z.useForm(),ae=M()(s,1),B=ae[0],ee=te.visible,g=te.current,ne=te.onCancel,v=te.actionReload,P=(0,D.Z)({submitLoading:!1,_id:null,uploading:!1,fileList:[],id:null}),U=M()(P,2),le=U[0],F=U[1];(0,j.useEffect)(function(){B&&ee&&(g?(B.resetFields(),B.setFieldsValue(g),F(E()({},g))):(F({id:null,fileList:[]}),B.resetFields()))},[ee]);var fe=function(){var z=l()(O()().mark(function K(){var J,m,oe,L;return O()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:return B.submit(),e.prev=3,e.next=6,B.validateFields();case 6:return J=e.sent,F({submitLoading:!0}),m=le.id,oe=g._id,e.next=12,(0,I.T)(E()(E()({},J),{},{id:m,_id:oe}));case 12:L=e.sent,L&&(V.ZP.success("".concat(g?"\u4FDD\u5B58":"\u65B0\u589E","\u9644\u4EF6\u6210\u529F\uFF01")),ne(),v()),F({submitLoading:!1}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),console.log("Failed:",e.t0);case 20:case"end":return e.stop()}},K,null,[[3,17]])}));return function(){return z.apply(this,arguments)}}(),W={okText:"\u4FDD\u5B58",onOk:fe,onCancel:ne},Ce=function(){var z=l()(O()().mark(function K(J){var m,oe,L,pe,e,Pe,je,de,Be;return O()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(m=J.name,oe=J.size,!(oe>=10485760)){ue.next=4;break}return V.ZP.warning("\u6587\u4EF6\u8FC7\u5927\uFF01\u53EA\u652F\u630110MB\u4EE5\u5185\u7684\u6587\u4EF6\uFF01"),ue.abrupt("return",!1);case 4:if(L=m.toLowerCase(),!(L.indexOf(".exe")>0)){ue.next=8;break}return V.ZP.warning("\u6587\u4EF6\u7C7B\u578B\u4E0D\u652F\u6301\uFF01"),ue.abrupt("return",!1);case 8:return F({uploading:!0,fileList:[{name:m,uid:m,status:"uploading"}]}),ue.next=11,(0,$.c)(J,"att",!0);case 11:return pe=ue.sent,e=pe.success,Pe=pe.data,je=pe.error,e?(de=Pe.name,Be=Pe.id,F({id:Be}),B.setFieldsValue({name:de,showname:de}),F({uploading:!1,fileList:[{name:de,uid:de,status:"done"}]})):(V.ZP.error(je),F({uploading:!1,fileList:[{name:m,uid:m,status:"error",response:je}]})),ue.abrupt("return",!1);case 17:case"end":return ue.stop()}},K)}));return function(J){return z.apply(this,arguments)}}(),k=function(){var z=l()(O()().mark(function K(){return O()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:console.log("\u6587\u4EF6\u4E0A\u4F20\u6210\u529F");case 1:case"end":return m.stop()}},K)}));return function(){return z.apply(this,arguments)}}(),ve=function(){return(0,T.jsxs)(x.Z,E()(E()({},p),{},{form:B,size:"large",children:[(0,T.jsx)(x.Z.Item,{name:"upload",label:"\u4E0A\u4F20\u9644\u4EF6",children:(0,T.jsx)(y.Z,{fileList:le.fileList,name:"file",beforeUpload:Ce,customRequest:k,children:(0,T.jsx)(f.ZP,{icon:(0,T.jsx)(ie.Z,{}),children:"\u4E0A\u4F20"})})}),(0,T.jsx)(x.Z.Item,{name:"showname",label:"\u663E\u793A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0"}],children:(0,T.jsx)(R.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BE5\u663E\u793A\u540D\u79F0\uFF0C\u5C06\u5728\u90AE\u4EF6\u4E2D\u5C55\u793A"})}),(0,T.jsx)(x.Z.Item,{name:"name",label:"\u9644\u4EF6\u5907\u6CE8",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9644\u4EF6\u5907\u6CE8"}],children:(0,T.jsx)(R.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BE5\u9644\u4EF6\u7684\u5907\u6CE8"})})]}))};return(0,T.jsx)(Z.Z,E()(E()({title:"".concat(g?"\u7F16\u8F91":"\u65B0\u589E","\u9644\u4EF6"),className:_.standardListForm,width:720,bodyStyle:{padding:"24px 24px 24px"},destroyOnClose:!0,open:ee,maskClosable:!1},W),{},{children:ve()}))},H=q},33349:function(ye,ce,n){n.d(ce,{Z:function(){return p}});var _e=n(35290),O=n.n(_e),me=n(30279),l=n.n(me),Ee=n(411),E=n.n(Ee),he=n(46686),M=n.n(he),j=n(85170),x=n(31810),V=n(41318),y=n(2800),f=n(6771),R=n(58110),Z={standardListForm:"standardListForm___FEB8q"},_=n(74729),I=n(1166),ie=n(30481),D=n(43010),$={labelCol:{span:7},wrapperCol:{span:13}},T=function(H){var se=x.Z.useForm(),te=M()(se,1),s=te[0],ae=H.visible,B=H.current,ee=H.onCancel,g=H.actionReload,ne=(0,I.Z)({testLoading:!1,submitLoading:!1,_id:null,nameStatus:"error",nameHelp:"\u53EA\u80FD\u4F7F\u7528\u5B57\u6BCD(a-z)\u3001\u6570\u5B57(0-9)\u3001\u7B26\u53F7(_-.)\u7EC4\u6210"}),v=M()(ne,2),P=v[0],U=v[1];(0,j.useEffect)(function(){s&&ae&&(s.resetFields(),B&&(U({nameStatus:"success"}),s.setFieldsValue(B)))},[ae]);var le=function(){var Ce=E()(O()().mark(function k(){var ve,z,K;return O()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(ve=P.nameStatus,ve!=="error"){m.next=3;break}return m.abrupt("return");case 3:if(s){m.next=5;break}return m.abrupt("return");case 5:return s.submit(),m.prev=6,m.next=9,s.validateFields();case 9:return z=m.sent,U({submitLoading:!0}),m.next=13,(0,_.Hc)(l()({},z));case 13:K=m.sent,K&&(s.resetFields(),V.ZP.success("".concat(B?"\u4FDD\u5B58":"\u65B0\u589E","\u7CFB\u7EDF\u8D26\u53F7\u6210\u529F\uFF01")),ee(),g()),U({submitLoading:!1}),m.next=21;break;case 18:m.prev=18,m.t0=m.catch(6),console.log("Failed:",m.t0);case 21:case"end":return m.stop()}},k,null,[[6,18]])}));return function(){return Ce.apply(this,arguments)}}(),F={okText:"\u4FDD\u5B58",onOk:le,onCancel:ee},fe=function(){var Ce=E()(O()().mark(function k(ve,z){var K,J,m,oe,L;return O()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(K=ve.name,J=z._id,!K){e.next=13;break}if(m=/^[A-Za-z0-9_\-.]{6,30}$/,!m.test(K)){e.next=12;break}return e.next=7,(0,_.K4)({id:J,name:K});case 7:oe=e.sent,L=oe.success,U(L?{nameHelp:"",nameStatus:"success"}:{nameHelp:"\u5DF2\u6709\u4EBA\u4F7F\u7528\u4E86\u8BE5\u7528\u6237\u540D\uFF0C\u8BF7\u5C1D\u8BD5\u5176\u4ED6\u7528\u6237\u540D",nameStatus:"error"}),e.next=13;break;case 12:K.length<6?U({nameHelp:"\u5B57\u7B26\u6570\u957F\u5EA66-30",nameStatus:"error"}):U({nameHelp:"\u53EA\u80FD\u4F7F\u7528\u5B57\u6BCD(a-z)\u3001\u6570\u5B57(0-9)\u3001\u6570\u70B9(.)\u7EC4\u6210",nameStatus:"error"});case 13:case"end":return e.stop()}},k)}));return function(ve,z){return Ce.apply(this,arguments)}}(),W=function(){return(0,D.jsxs)(x.Z,l()(l()({},$),{},{form:s,onValuesChange:fe,children:[(0,D.jsx)(x.Z.Item,{hidden:!0,name:"_id",label:"\u4FDD\u5B58id",children:(0,D.jsx)(y.Z,{})}),(0,D.jsx)(x.Z.Item,{name:"name",label:(0,D.jsxs)("span",{children:["\u53D1\u4EF6\u4EBA\u90AE\u7BB1\xA0",(0,D.jsx)(f.Z,{title:"\u53EA\u80FD\u4F7F\u7528\u5B57\u6BCD(a-z)\u3001\u6570\u5B57(0-9)\u3001\u6570\u70B9(.)\u7EC4\u6210\uFF0C\u521B\u5EFA\u540E\u4E0D\u80FD\u4FEE\u6539",children:(0,D.jsx)(ie.Z,{})})]}),validateStatus:P.nameStatus,help:P.nameHelp,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u4EF6\u4EBA\u90AE\u7BB1"}],children:(0,D.jsx)(y.Z,{placeholder:"\u5982\uFF1Aname",addonAfter:"@\u7CFB\u7EDF\u53D1\u4FE1\u57DF\u540D",disabled:B})}),(0,D.jsx)(x.Z.Item,{name:"fromName",label:"\u53D1\u4EF6\u4EBA\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u4EF6\u4EBA\u540D\u79F0"}],children:(0,D.jsx)(y.Z,{placeholder:"\u5982\uFF1A\u5F20\u4E09"})})]}))};return(0,D.jsx)(R.Z,l()(l()({title:"".concat(B?"\u7F16\u8F91":"\u65B0\u589E","\u7CFB\u7EDF\u90AE\u7BB1"),className:Z.standardListForm,width:640,bodyStyle:{padding:"28px 0 0"},destroyOnClose:!0,open:ae,confirmLoading:P.submitLoading,maskClosable:!1},F),{},{children:W()}))},p=T},33131:function(ye,ce,n){var _e=n(93275),O=n.n(_e),me=n(30279),l=n.n(me),Ee=n(35290),E=n.n(Ee),he=n(411),M=n.n(he),j=n(46686),x=n.n(j),V=n(85170),y=n(31810),f=n(41318),R=n(96498),Z=n(46394),_=n(28931),I=n(73575),ie=n(18799),D=n(2800),$=n(77707),T=n(6771),p=n(16798),q=n(43520),H=n(42147),se=n(43267),te=n(36765),s=n(87662),ae=n(65191),B=n(43525),ee=n(10248),g=n(13949),ne=n(1166),v=n(22196),P=n(78730),U=n(90460),le=n(64377),F=n(85495),fe=n(61620),W=n(87424),Ce=n(42109),k=n(82964),ve=n(88665),z=n(74729),K=n(70683),J=n(33349),m=n(70176),oe=n(12653),L=n(61825),pe=n(43522),e=n(43010),Pe=function(de){var Be=de.visible,xe=de.onCancel,ue=de.actionReload,Ze=de.taskId,Fe=de.action,We=(0,v.useModel)("@@initialState"),Y=We.initialState,S=0;Y!=null&&Y.currentUser&&(S=Y.currentUser.vip);var X=y.Z.useForm(),N=x()(X,1),C=N[0],Te=(0,ne.Z)({mode:"view",channel:2,sendAtOnce:!0,timeStart:0,choiceNum:0,sendCount:0,memberOptions:[],senderOptions:[],senderVisible:!1,accountOptions:[],accountVisible:!1,subjectTreeData:[],contentTreeData:[],includeTreeData:[],excludeTreeData:[],attachmentOptions:[],replyOptions:[],replyVisible:!1,subjectVisible:!1,contentVisible:!1,timeVisible:!1,previewVisible:!1,attachmentVisible:!1,preview:!1,change:!1,gtid:"",status:"unkown",saveLoading:!1,costStatus:0,payBalanceVisible:!1,payPackageVisible:!1,qrcodeVisible:!1,id:"",app:"",codeUrl:"",otherEditStatus:!1,track:{status:!0},timeSleep:{status:!0,value:60},replyTo:{status:!1,value:""},fromName:{status:!1,value:""},attNormal:{status:!1},proxy:{status:!1},cids:[],subjectsIds:[],contentsIds:[],step:0,isOrg:!1,limitSetting:!1,skipNum:0,limitNum:10,customers:[]}),re=x()(Te,2),a=re[0],d=re[1],Se=(0,v.useRequest)(ee.pm),be=Se.data,Re=(0,v.useRequest)(ee.Iy),Oe=Re.data,Ie=function(){var u=a.channel,t=a.track,i=a.timeSleep,r=a.replyTo,h=a.fromName,G=a.proxy,b=a.attNormal,A={track:!1};return t.status&&(A.track=!0),h.status&&(A.fromName=h.value),u===1&&(A.timeSleep=i.value),r.status&&r.value&&(A.replyTo=r.value),G.status&&(A.proxy=!0),b.status&&(A.attNormal=!0),A},Le=(0,v.useRequest)(z.jz,{manual:!0,onSuccess:function(u){var t=u.map(function(i){return i.mail_name?{label:"".concat(i.mail_addr,"(").concat(i.mail_name,")"),value:i.maid}:{label:"".concat(i.mail_addr),value:i.maid}});d({accountOptions:t})}}),ke=Le.run,Q=(0,v.useRequest)(z.DG,{manual:!0,onSuccess:function(u){if(u){var t=u.map(function(i){return{label:"".concat(i.name,"(").concat(i.fromName,")"),value:i._id}});d({senderOptions:t}),u.length&&C.setFieldsValue({senders:[u[0]._id]})}}}),we=Q.run,ze=(0,v.useRequest)(z.wA,{manual:!0,onSuccess:function(u){d({contentTreeData:u})}}),en=ze.run,nn=ze.refresh,Ne=(0,v.useRequest)(z.Wp,{manual:!0,onSuccess:function(u){d({attachmentOptions:u})}}),un=Ne.run,rn=Ne.refresh,Ve=(0,v.useRequest)(g.DI,{manual:!0,onSuccess:function(u){var t=u.count,i=u.sendCount,r=u.customers;d({choiceNum:t,skipNum:0,limitNum:t,sendCount:i,customers:r})}}),$e=Ve.run,Ke=Ve.loading,Me=function(){var o=M()(E()().mark(function u(){var t,i,r,h;return E()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(t=a.mode,i=C.getFieldsValue(),r=i.match,h=i.exclude,!(r&&r.length)){b.next=8;break}return b.next=6,$e({match:r,exclude:h,mode:t});case 6:b.next=9;break;case 8:d({choiceNum:0});case 9:case"end":return b.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),He=(0,v.useRequest)(g.Eg,{manual:!0,onSuccess:function(){xe(),f.ZP.success("\u4EFB\u52A1\u521B\u5EFA\u6210\u529F!"),ue()}}),sn=He.run,Ge=He.loading,tn=(0,v.useRequest)(g.C3,{manual:!0,onSuccess:function(){xe(),f.ZP.success("\u4EFB\u52A1\u63D0\u4EA4\u6210\u529F!"),ue()}}),an=tn.run,ln=function(){var o=M()(E()().mark(function u(t){var i,r,h,G,b,A,w,c,Ue;return E()().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(i=a.choiceNum,r=a.replyTo,i){Ae.next=4;break}return f.ZP.warning("\u8BF7\u9009\u62E9\u6536\u4EF6\u4EBA!"),Ae.abrupt("return");case 4:if(!r.status){Ae.next=9;break}if(h=/\w[-\w.+]*@([-A-Za-z0-9]+\.)+[A-Za-z]{1,14}/,h.test(r.value)){Ae.next=9;break}return f.ZP.error("\u56DE\u4FE1\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E!"),Ae.abrupt("return");case 9:if(!(r.status&&!r.value)){Ae.next=12;break}return f.ZP.error("\u8BF7\u8F93\u5165\u56DE\u4FE1\u90AE\u7BB1!"),Ae.abrupt("return");case 12:G=a.sendAtOnce,b=a.timeStart,A=a.mode,w=a.skipNum,c=a.limitNum,Ue=Ie(),Fe==="change"?an(l()(l()(l()({},t),Ue),{},{gtid:Ze,mode:A})):sn(l()(l()(l()({},t),Ue),{},{sendAtOnce:G,timeStart:b,mode:A,skipNum:w,limitNum:c}));case 15:case"end":return Ae.stop()}},u)}));return function(t){return o.apply(this,arguments)}}(),on=function(){var o=M()(E()().mark(function u(){var t;return E()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,C.validateFields();case 3:r.next=9;break;case 5:return r.prev=5,r.t0=r.catch(0),console.log("Failed:",r.t0),r.abrupt("return");case 9:if(t=a.choiceNum,t){r.next=13;break}return f.ZP.warning("\u8BF7\u9009\u62E9\u6536\u4EF6\u4EBA!"),r.abrupt("return");case 13:d({timeVisible:!0});case 14:case"end":return r.stop()}},u,null,[[0,5]])}));return function(){return o.apply(this,arguments)}}(),dn=(0,v.useRequest)(g.r8,{manual:!0,onSuccess:function(){f.ZP.success("\u4FDD\u5B58\u6210\u529F."),d({otherEditStatus:!1})}}),cn=dn.run,Ye=function(){var o=M()(E()().mark(function u(){var t,i,r,h,G,b,A;return E()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=a.track,i=a.timeSleep,r=a.replyTo,h=a.fromName,G=a.proxy,b=a.attNormal,!(h.status&&!h.value)){c.next=4;break}return f.ZP.error("\u8BF7\u8F93\u5165\u53D1\u4FE1\u5462\u79F0!"),c.abrupt("return");case 4:if(!(h.status&&h.value.length>32)){c.next=7;break}return f.ZP.error("\u53D1\u4FE1\u5462\u79F0\u957F\u5EA6\u8D85\u8FC7\u9650\u5236"),c.abrupt("return");case 7:if(!r.status){c.next=12;break}if(A=/\w[-\w.+]*@([-A-Za-z0-9]+\.)+[A-Za-z]{1,14}/,A.test(r.value)){c.next=12;break}return f.ZP.error("\u56DE\u4FE1\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E!"),c.abrupt("return");case 12:if(!(r.status&&!r.value)){c.next=15;break}return f.ZP.error("\u8BF7\u8F93\u5165\u56DE\u4FE1\u90AE\u7BB1!"),c.abrupt("return");case 15:cn({track:t,timeSleep:i,replyTo:r,fromName:h,proxy:G,attNormal:b});case 16:case"end":return c.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),De=function(u,t){d(O()({},u,t)),d({otherEditStatus:!0})},Qe=function(u){var t=a.replyTo;u||d({proxy:{status:u}}),d({replyTo:l()(l()({},t),{},{status:u})}),d({otherEditStatus:!0})},_n=function(u){var t=a.replyTo;u&&d({replyTo:l()(l()({},t),{},{status:u})}),d({proxy:{status:u}}),d({otherEditStatus:!0})},mn=function(u){var t=a.attachmentOptions,i=0;if(!u)return 0;var r=function(b){var A=u[b],w=t.findIndex(function(Ue){return Ue.value===A}),c=t[w].size;i+=c};for(var h in u)r(h);return i},En=function(){var o=M()(E()().mark(function u(t){var i,r,h;return E()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:i=t.channel,r=t.attIds,i&&(d({channel:i}),C.setFieldsValue({senders:[]})),r&&(r&&r.length>5?(C.setFieldsValue({attIds:r.slice(0,5)}),f.ZP.error("\u9644\u4EF6\u6700\u591A\u4E3A5\u4E2A")):a.attNormal.status&&(h=mn(r),h>204800&&(C.setFieldsValue({attIds:r.slice(0,r.length-1)}),f.ZP.error("\u666E\u901A\u9644\u4EF6\u603B\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7200KB"))));case 3:case"end":return b.stop()}},u)}));return function(t){return o.apply(this,arguments)}}(),ge=function(u){var t=a.step;return t!==u},hn=(0,v.useRequest)(g.Oo,{manual:!0,onSuccess:function(u){u&&d(l()({},u))}}),fn=hn.run,vn=function(u){var t=u.track,i=u.timeSleep,r=u.replyTo,h=u.fromName,G=u.proxy,b=u.attNormal;t&&d({track:{status:!0}}),i&&d({timeSleep:{status:!0,value:i}}),r&&d({replyTo:{status:!0,value:r}}),h&&d({fromName:{status:!0,value:h}}),G&&d({proxy:{status:!0}}),b&&d({attNormal:{status:!0}})},pn=(0,v.useRequest)(g.eE,{manual:!0,onSuccess:function(u){if(!!u){var t=u.match,i=u.exclude,r=u.gtid,h=u.total_count,G=u.mode;G||(G="view"),Fe!=="change"&&($e({match:t,exclude:i,mode:G}),vn(u)),C.setFieldsValue(u),d({gtid:r,choiceNum:h,mode:G})}}}),Fn=pn.run,Dn=function(){if(Ze)Fn({gtid:Ze});else{var u="\u7FA4\u53D1\u4EFB\u52A1.".concat((0,ve.vQ)());C.setFieldsValue({name:u,channel:2})}};(0,V.useEffect)(function(){Be&&(d({step:0}),C.resetFields(),Dn(),fn(),ke(),we(),en(),un())},[Be]);var Cn=function(){var u=a.channel,t=a.track,i=a.timeSleep,r=a.replyTo,h=a.fromName,G=a.proxy,b=a.attNormal,A={xs:24,sm:24,md:24,lg:24,xl:24,style:{marginBottom:12,marginTop:12,paddingLeft:12}};return u===1?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(R.Z,{children:[(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:t.status,onChange:function(c){return De("track",{track:{status:c}})}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u90AE\u4EF6\u8FFD\u8E2A(\u9605\u8BFB\u3001\u94FE\u63A5\u3001\u9644\u4EF6)"})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u8FFD\u8E2A\u9605\u8BFB\u90AE\u4EF6\u3001\u70B9\u51FB\u90AE\u4EF6\u6B63\u6587\u94FE\u63A5\u3001\u4EE5\u53CA\u4E0B\u8F7D\u9644\u4EF6\u7684\u5BA2\u6237"})]})),(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:!0,disabled:!0}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u53D1\u4FE1\u901F\u5EA6\uFF1A"}),(0,e.jsx)(ie.Z,{min:S===2?6:60,max:9999,value:i.value,onChange:function(c){return De("timeSleep",l()(l()({},i),{},{value:c}))}})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u8BE5\u4EFB\u52A1\u5C06\u4EE5\u4F60\u8BBE\u7F6E\u7684\u901F\u5EA6\u8FDB\u884C\u53D1\u9001\uFF0C\u5355\u4F4D\uFF1A\u79D2/\u5C01"})]}))]}),(0,e.jsxs)(R.Z,{style:{marginTop:12},children:[(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:r.status,onChange:function(c){return Qe(c)}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u56DE\u4FE1\u90AE\u7BB1\uFF1A"}),(0,e.jsx)(D.Z,{value:r.value,onChange:function(c){return De("replyTo",l()(l()({},r),{},{value:c.target.value,status:!0}))},hidden:!r.status})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u5BA2\u6237\u90AE\u4EF6\u5C06\u56DE\u590D\u5230\u8FD9\u4E2A\u90AE\u7BB1\uFF0C\u8BF7\u52A1\u5FC5\u786E\u4FDD\u6B63\u786E."})]})),(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:h.status,onChange:function(c){return De("fromName",l()(l()({},h),{},{status:c}))}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u53D1\u4FE1\u5462\u79F0\uFF1A"}),(0,e.jsx)(D.Z,{value:h.value,onChange:function(c){return De("fromName",l()(l()({},h),{},{value:c.target.value,status:!0}))},hidden:!h.status})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u5BA2\u6237\u6536\u5230\u90AE\u4EF6\u540E\uFF0C\u5728\u53D1\u4FE1\u4EBA\u5904\u770B\u5230\u7684\u5462\u79F0"})]}))]}),(0,e.jsx)(R.Z,{style:{marginTop:12},children:(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)("label",{style:{fontWeight:500},children:"\u9644\u4EF6\u7C7B\u578B"}),(0,e.jsxs)($.ZP.Group,{onChange:function(c){return De("attNormal",{status:c.target.value})},value:b.status,children:[(0,e.jsx)($.ZP,{value:!1,children:"\u6B63\u6587\u9644\u4EF6"}),(0,e.jsx)($.ZP,{value:!0,children:"\u666E\u901A\u9644\u4EF6"})]})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u6B63\u6587\u9644\u4EF6\u5E26\u5728\u90AE\u4EF6\u6B63\u6587\u672B\u5C3E\uFF0C\u53EF\u7EDF\u8BA1\u9644\u4EF6\u4E0B\u8F7D\u6570\u636E\uFF0C\u666E\u901A\u9644\u4EF6\u4E0D\u53EF\u7EDF\u8BA1"})]}))}),(0,e.jsx)(T.Z,{title:"\u4FDD\u5B58\u540E\u4E0B\u6B21\u4F1A\u81EA\u52A8\u52A0\u8F7D\u8BBE\u7F6E",children:(0,e.jsx)(p.ZP,{type:"primary",size:"small",onClick:function(){return Ye()},disabled:!a.otherEditStatus,style:{marginTop:24,marginLeft:12},children:"\u8BBE\u4E3A\u9ED8\u8BA4"})})]}):u===2?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(R.Z,{children:[(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:t.status,onChange:function(c){return De("track",{status:c})}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u90AE\u4EF6\u8FFD\u8E2A(\u9605\u8BFB\u3001\u94FE\u63A5\u3001\u9644\u4EF6)"})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u8FFD\u8E2A\u9605\u8BFB\u90AE\u4EF6\u3001\u70B9\u51FB\u90AE\u4EF6\u6B63\u6587\u94FE\u63A5\u3001\u4EE5\u53CA\u4E0B\u8F7D\u9644\u4EF6\u7684\u5BA2\u6237"})]})),(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:h.status,onChange:function(c){return De("fromName",l()(l()({},h),{},{status:c}))}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u53D1\u4FE1\u5462\u79F0\uFF1A"}),(0,e.jsx)(D.Z,{value:h.value,onChange:function(c){return De("fromName",l()(l()({},h),{},{value:c.target.value,status:!0}))},hidden:!h.status})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u5BA2\u6237\u6536\u5230\u90AE\u4EF6\u540E\uFF0C\u5728\u53D1\u4FE1\u4EBA\u5904\u770B\u5230\u7684\u5462\u79F0"})]}))]}),(0,e.jsxs)(R.Z,{style:{marginTop:12},children:[(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:r.status,onChange:function(c){return Qe(c)}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u56DE\u4FE1\u90AE\u7BB1\uFF1A"}),(0,e.jsx)(D.Z,{value:r.value,onChange:function(c){return De("replyTo",l()(l()({},r),{},{value:c.target.value,status:!0}))},hidden:!r.status})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u5BA2\u6237\u90AE\u4EF6\u5C06\u56DE\u590D\u5230\u8FD9\u4E2A\u90AE\u7BB1\uFF0C\u8BF7\u52A1\u5FC5\u786E\u4FDD\u6B63\u786E."})]})),(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(I.Z,{checked:G.status,onChange:function(c){return _n(c)}}),(0,e.jsx)("label",{style:{fontWeight:500},children:"\u4EE3\u53D1\u6A21\u5F0F"})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u53D1\u4EF6\u4EBA\u663E\u793A\u56DE\u4FE1\u90AE\u7BB1\u5730\u5740"})]}))]}),(0,e.jsx)(R.Z,{style:{marginTop:12},children:(0,e.jsxs)(Z.Z,l()(l()({},A),{},{children:[(0,e.jsxs)(_.Z,{children:[(0,e.jsx)("label",{style:{fontWeight:500},children:"\u9644\u4EF6\u7C7B\u578B"}),(0,e.jsxs)($.ZP.Group,{onChange:function(c){return De("attNormal",{status:c.target.value})},value:b.status,children:[(0,e.jsx)($.ZP,{value:!1,children:"\u6B63\u6587\u9644\u4EF6"}),(0,e.jsx)($.ZP,{value:!0,children:"\u666E\u901A\u9644\u4EF6"})]})]}),(0,e.jsx)("div",{style:{fontSize:12,color:"#999999",marginTop:6},children:"\u6B63\u6587\u9644\u4EF6\u5E26\u5728\u90AE\u4EF6\u6B63\u6587\u672B\u5C3E\uFF0C\u53EF\u7EDF\u8BA1\u9644\u4EF6\u4E0B\u8F7D\u6570\u636E\uFF0C\u666E\u901A\u9644\u4EF6\u4E0D\u53EF\u7EDF\u8BA1"})]}))}),(0,e.jsx)(T.Z,{title:"\u4FDD\u5B58\u540E\u4E0B\u6B21\u4F1A\u81EA\u52A8\u52A0\u8F7D\u8BBE\u7F6E",children:(0,e.jsx)(p.ZP,{type:"primary",size:"small",onClick:function(){return Ye()},disabled:!a.otherEditStatus,style:{marginTop:24,marginLeft:12},children:"\u8BBE\u4E3A\u9ED8\u8BA4"})})]}):(0,e.jsx)(e.Fragment,{})},gn=function(){return(0,e.jsxs)(y.Z,{layout:"vertical",size:"large",form:C,onValuesChange:En,onFinish:ln,children:[Fe==="change"?null:(0,e.jsxs)(y.Z.Item,{hidden:ge(0),children:[a.limitSetting?null:(0,e.jsx)("div",{children:(0,e.jsx)("a",{onClick:function(){return d({limitSetting:!0})},style:{borderBottom:"1px solid blue",fontSize:16},children:"\u6570\u91CF\u81EA\u5B9A\u4E49"})}),a.limitSetting?(0,e.jsx)("div",{children:(0,e.jsxs)(_.Z,{size:"small",children:[(0,e.jsxs)("span",{children:[(0,e.jsx)("label",{style:{fontWeight:500,fontSize:16},children:"\u8DF3\u8FC7\u6570\u91CF\uFF1A"}),(0,e.jsx)(ie.Z,{min:0,max:a.choiceNum,value:a.skipNum,onChange:function(t){return d({skipNum:t})},style:{width:120}})]}),(0,e.jsxs)("span",{style:{marginLeft:24},children:[(0,e.jsx)("label",{style:{fontWeight:500,fontSize:16},children:"\u6700\u5927\u53D1\u9001\u6570\u91CF\uFF1A"}),(0,e.jsx)(ie.Z,{min:1,max:a.choiceNum,value:a.limitNum,onChange:function(t){return d({limitNum:t})},style:{width:120}})]})]})}):null]}),(0,e.jsx)(y.Z.Item,{name:"name",label:"\u4EFB\u52A1\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8BBE\u7F6E\u4EFB\u52A1\u540D\u79F0"}],hidden:ge(0),children:(0,e.jsx)(D.Z,{placeholder:"\u5982\uFF1A\u4EFB\u52A11.0"})}),(0,e.jsx)(y.Z.Item,{name:"channel",label:"\u53D1\u4FE1\u6E20\u9053",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u9001\u6E20\u9053"}],hidden:ge(1),tooltip:"\u9009\u62E9\u90AE\u4EF6\u53D1\u9001\u7684\u65B9\u5F0F\uFF0C\u4F18\u8D28\u53D1\u9001\u901A\u9053\u4E3A\u6765\u53D1\u4FE1\u5E73\u53F0\u4EE3\u53D1\u65B9\u5F0F\uFF0C\u6211\u7684\u90AE\u7BB1\u5219\u7528\u6237\u9700\u8981\u6DFB\u52A0\u81EA\u5DF1\u7684\u90AE\u7BB1",children:(0,e.jsxs)($.ZP.Group,{disabled:Fe==="change",children:[(0,e.jsx)($.ZP,{value:2,children:"\u4F18\u8D28\u53D1\u9001\u901A\u9053"}),(0,e.jsx)($.ZP,{value:1,children:"\u6211\u7684\u90AE\u7BB1"})]})}),a.channel===1?(0,e.jsx)(y.Z.Item,{name:"senders",label:"\u53D1\u4EF6\u90AE\u7BB1",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u4EF6\u90AE\u7BB1"}],hidden:ge(1),children:(0,e.jsx)(q.Z,{mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u53D1\u4EF6\u90AE\u7BB1\uFF0C\u9009\u4E2D\u591A\u4E2A\u5219\u6BCF\u6B21\u53D1\u9001\u90AE\u4EF6\u90FD\u4F1A\u968F\u673A\u9009\u62E9",disabled:a.preview,optionFilterProp:"label",options:a.accountOptions,showArrow:!0,dropdownRender:function(t){return(0,e.jsxs)("div",{children:[t,(0,e.jsx)(H.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",padding:0},children:(0,e.jsxs)("a",{style:{flex:"none",padding:"8px",display:"block",cursor:"pointer"},onClick:function(){return d({accountVisible:!0})},children:[(0,e.jsx)(P.Z,{})," \u6DFB\u52A0\u6211\u7684\u90AE\u7BB1"]})})]})}})}):(0,e.jsx)(y.Z.Item,{name:"senders",label:"\u53D1\u4EF6\u8D26\u53F7",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u4EF6\u8D26\u53F7"}],hidden:ge(1),children:(0,e.jsx)(q.Z,{mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u53D1\u4EF6\u8D26\u53F7\uFF0C\u9009\u4E2D\u591A\u4E2A\u5219\u6BCF\u6B21\u53D1\u9001\u90AE\u4EF6\u90FD\u4F1A\u968F\u673A\u9009\u62E9",optionFilterProp:"label",options:a.senderOptions,showArrow:!0,dropdownRender:function(t){return(0,e.jsxs)("div",{children:[t,(0,e.jsx)(H.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",padding:0},children:(0,e.jsxs)("a",{style:{flex:"none",padding:"8px",display:"block",cursor:"pointer"},onClick:function(){return d({senderVisible:!0})},children:[(0,e.jsx)(P.Z,{})," \u6DFB\u52A0\u7CFB\u7EDF\u8D26\u53F7"]})})]})}})}),Fe==="change"?null:(0,e.jsx)(y.Z.Item,{name:"match",label:"\u6536\u4EF6\u4EBA",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u9001\u5BF9\u8C61"}],hidden:ge(0),tooltip:"\u9009\u62E9\u5C06\u53D1\u9001\u7684\u89C6\u56FE\uFF0C\u53EF\u591A\u9009",children:(0,e.jsx)(se.Z,{virtual:!1,treeCheckable:!0,showSearch:!0,placeholder:"\u8BF7\u9009\u62E9\u6536\u4EF6\u4EBA",onBlur:Me,onClear:Me,onDeselect:Me,treeNodeFilterProp:"title",treeDefaultExpandAll:!0,filterTreeNode:function(t,i){var r;return(r=i.title)===null||r===void 0?void 0:r.toLowerCase().includes(t==null?void 0:t.toLowerCase())},treeData:[{value:"view",key:"view",title:"\u8054\u7CFB\u4EBA\u89C6\u56FE",disabled:!0,children:be},{value:"tags",key:"tags",title:"\u8054\u7CFB\u4EBA\u6807\u7B7E",disabled:!0,children:Oe}]})}),Fe==="change"?null:(0,e.jsx)(y.Z.Item,{name:"exclude",label:"\u6392\u9664\u5BF9\u8C61",hidden:ge(0),tooltip:"\u6392\u9664\u7684\u5BF9\u8C61\u5C06\u4E0D\u518D\u53D1\u9001",children:(0,e.jsx)(se.Z,{virtual:!1,treeCheckable:!0,showSearch:!0,placeholder:"\u9009\u4E2D\u7684\u5BF9\u8C61\u4E0D\u53D1\u9001",onBlur:Me,onClear:Me,onDeselect:Me,treeNodeFilterProp:"title",treeDefaultExpandAll:!0,filterTreeNode:function(t,i){var r;return(r=i.title)===null||r===void 0?void 0:r.toLowerCase().includes(t==null?void 0:t.toLowerCase())},treeData:[{value:"view",key:"view",title:"\u8054\u7CFB\u4EBA\u89C6\u56FE",disabled:!0,children:be},{value:"tags",key:"tags",title:"\u8054\u7CFB\u4EBA\u6807\u7B7E",disabled:!0,children:Oe}]})}),(0,e.jsx)(y.Z.Item,{name:"contentsIds",label:"\u90AE\u4EF6\u6A21\u677F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u90AE\u4EF6\u6A21\u677F"}],hidden:ge(0),children:(0,e.jsx)(se.Z,{virtual:!1,treeData:a.contentTreeData,placeholder:"\u8BF7\u9009\u62E9\u90AE\u4EF6\u6A21\u677F\uFF0C\u9009\u4E2D\u591A\u4E2A\u6A21\u677F\u5219\u6BCF\u6B21\u53D1\u9001\u90AE\u4EF6\u968F\u673A\u9009\u53D6",treeCheckable:!0,showCheckedStrategy:se.Z.SHOW_CHILD,treeDefaultExpandedKeys:["mine","team"],treeNodeFilterProp:"title",showArrow:!0,allowClear:!0,dropdownRender:function(t){return(0,e.jsxs)("div",{children:[t,(0,e.jsx)(H.Z,{style:{margin:"4px 0"}}),(0,e.jsxs)("div",{style:{display:"flex",flexWrap:"nowrap",padding:0},children:[(0,e.jsxs)("a",{style:{flex:"none",padding:"8px",display:"block",cursor:"pointer",marginRight:192},onClick:function(){return d({contentVisible:!0})},children:[(0,e.jsx)(P.Z,{})," \u6DFB\u52A0\u90AE\u4EF6\u6A21\u677F"]}),(0,e.jsxs)("a",{style:{flex:"none",padding:"8px",display:"block",cursor:"pointer",textAlign:"right"},onClick:function(){return v.history.push("/settings/templets")},children:[(0,e.jsx)(U.Z,{})," \u7BA1\u7406\u90AE\u4EF6\u6A21\u677F"]})]})]})}})}),(0,e.jsx)(y.Z.Item,{name:"attIds",label:"\u9644\u4EF6",hidden:ge(0),children:(0,e.jsx)(q.Z,{mode:"multiple",placeholder:"\u8BF7\u9009\u62E9\u9644\u4EF6(\u53EF\u9009)",optionFilterProp:"label",options:a.attachmentOptions,showArrow:!0,allowClear:!0,dropdownRender:function(t){return(0,e.jsxs)("div",{children:[t,(0,e.jsx)(H.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",padding:"8px"},children:(0,e.jsxs)("a",{style:{flex:"none",display:"block",cursor:"pointer"},onClick:function(){return d({attachmentVisible:!0})},children:[(0,e.jsx)(P.Z,{})," \u6DFB\u52A0\u9644\u4EF6"]})})]})}})}),(0,e.jsx)(y.Z.Item,{hidden:ge(2),children:Cn()})]})},An=function(){var o=M()(E()().mark(function u(){return E()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:d({sendAtOnce:!0}),C.submit();case 2:case"end":return i.stop()}},u)}));return function(){return o.apply(this,arguments)}}(),jn=function(u){d({timeStart:u,sendAtOnce:!1,timeVisible:!1}),C.submit()},Je=function(){var o=M()(E()().mark(function u(t){return E()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(C){r.next=2;break}return r.abrupt("return");case 2:return C.submit(),r.prev=3,r.next=6,C.validateFields();case 6:d({step:t+1}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(3),console.log("Failed:",r.t0);case 12:case"end":return r.stop()}},u,null,[[3,9]])}));return function(t){return o.apply(this,arguments)}}(),Xe=function(){var o=M()(E()().mark(function u(t){return E()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==0){r.next=2;break}return r.abrupt("return");case 2:if(C){r.next=4;break}return r.abrupt("return");case 4:return C.submit(),r.prev=5,r.next=8,C.validateFields();case 8:d({step:t-1}),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(5),console.log("Failed:",r.t0);case 14:case"end":return r.stop()}},u,null,[[5,11]])}));return function(t){return o.apply(this,arguments)}}(),xn=function(){var u=a.customers,t=u.map(function(r){return r.cid});if(!t.length){f.ZP.warning("\u8BF7\u9009\u62E9\u53D1\u9001\u5BF9\u8C61!!!");return}var i=C.getFieldValue("contentsIds");if(!i||!i.length){f.ZP.warning("\u8BF7\u9009\u62E9\u53D1\u9001\u6A21\u677F!!!");return}d({previewVisible:!0,cids:t,contentsIds:i})},qe=function(){return(0,e.jsxs)(p.ZP,{size:"large",onClick:xn,children:[(0,e.jsx)(le.Z,{}),"\u90AE\u4EF6\u9884\u89C8"]})},Bn=function(){var u=a.step;return u===0?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(_.Z,{size:"large",children:[(0,e.jsxs)(p.ZP,{size:"large",disabled:!0,children:[(0,e.jsx)(F.Z,{})," \u4E0A\u4E00\u6B65"]}),qe(),(0,e.jsxs)(p.ZP,{type:"primary",size:"large",onClick:function(){return Je(0)},children:["\u4E0B\u4E00\u6B65 ",(0,e.jsx)(fe.Z,{})]})]})}):u===1?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(_.Z,{size:"large",children:[(0,e.jsxs)(p.ZP,{size:"large",onClick:function(){return Xe(1)},children:[(0,e.jsx)(F.Z,{})," \u4E0A\u4E00\u6B65"]}),qe(),(0,e.jsxs)(p.ZP,{type:"primary",size:"large",onClick:function(){return Je(1)},children:["\u4E0B\u4E00\u6B65 ",(0,e.jsx)(fe.Z,{})]})]})}):u===2?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(_.Z,{size:"large",children:[(0,e.jsxs)(p.ZP,{size:"large",onClick:function(){return Xe(2)},children:[(0,e.jsx)(F.Z,{})," \u4E0A\u4E00\u6B65"]}),(0,e.jsxs)(p.ZP,{type:"primary",size:"large",onClick:An,loading:Ge,children:[(0,e.jsx)(W.Z,{rotate:-45}),"\u53D1\u9001"]}),(0,e.jsxs)(p.ZP,{size:"large",onClick:on,loading:Ge,children:[(0,e.jsx)(Ce.Z,{}),"\u5B9A\u65F6"]})]})}):null},Pn=function(){return Fe==="edit"?(0,e.jsxs)("span",{children:["\u7F16\u8F91\u7FA4\u53D1\u4EFB\u52A1 ",(0,e.jsx)("span",{style:{fontSize:12},children:"\u5DF2\u9009\u4E2D\u4EBA\u6570:"})," ",(0,e.jsx)("a",{children:Ke?(0,e.jsx)(k.Z,{}):a.choiceNum})]}):Fe==="change"?(0,e.jsxs)("span",{children:["\u4FEE\u6539\u7FA4\u53D1\u4EFB\u52A1 ",(0,e.jsx)("span",{style:{fontSize:12},children:"\u5DF2\u9009\u4E2D\u4EBA\u6570:"})," ",(0,e.jsx)("a",{children:Ke?(0,e.jsx)(k.Z,{}):a.choiceNum})]}):(0,e.jsxs)("span",{children:["\u65B0\u5EFA\u7FA4\u53D1\u4EFB\u52A1 ",(0,e.jsx)("span",{style:{fontSize:12},children:"\u5DF2\u9009\u4E2D\u4EBA\u6570:"})," ",(0,e.jsx)("a",{children:Ke?(0,e.jsx)(k.Z,{}):a.choiceNum})]})},bn=function(u){var t=a.step;u>=t||d({step:u})};return(0,e.jsxs)(te.Z,{destroyOnClose:!0,width:640,title:Pn(),placement:"right",open:Be,onClose:function(){return xe()},footer:Bn(),maskClosable:!1,children:[(0,e.jsx)(s.Z,{current:a.step,onChange:bn,items:[{title:"\u53D1\u9001\u8BBE\u7F6E"},{title:"\u8D26\u53F7\u9009\u62E9"},{title:"\u5176\u4ED6\u8BBE\u7F6E"},{title:"\u5B8C\u6210"}]}),(0,e.jsx)(H.Z,{}),a.step<3?gn():(0,e.jsx)(ae.ZP,{status:"success",title:"\u53D1\u9001\u90AE\u4EF6\u4EFB\u52A1\u63D0\u4EA4\u6210\u529F",subTitle:"\u4EFB\u52A1\u5BA1\u6838\u6210\u529F\u540E\u5C06\u5728\u540E\u53F0\u81EA\u52A8\u53D1\u9001\u3002",extra:[(0,e.jsx)(p.ZP,{type:"primary",onClick:function(){return d({step:0})},children:"\u7EE7\u7EED\u53D1\u9001"},"send"),(0,e.jsx)(p.ZP,{onClick:function(){return v.history.push("/marketing/tasks")},children:"\u67E5\u770B\u4EFB\u52A1"},"showTask")]}),a.sendCount<a.choiceNum&&Fe!=="change"?(0,e.jsx)(B.Z,{message:"\u7FA4\u53D1\u989D\u5EA6\u4E0D\u8DB3",showIcon:!0,description:"\u7FA4\u53D1\u989D\u5EA6\u4E0D\u8DB3\uFF0C\u8BF7\u8D2D\u4E70\u540E\u518D\u64CD\u4F5C",type:"error",action:(0,e.jsx)("a",{onClick:function(){return v.history.push("/expenses/purchase?type=sendCount")},children:"\u8D2D\u4E70"})}):null,(0,e.jsx)(K.Z,{visible:a.accountVisible,actionReload:ke,onCancel:function(){return d({accountVisible:!1})}}),(0,e.jsx)(J.Z,{visible:a.senderVisible,actionReload:we,onCancel:function(){return d({senderVisible:!1})},current:!1}),(0,e.jsx)(m.Z,{visible:a.timeVisible,onCancel:function(){return d({timeVisible:!1})},sendAction:function(u){return jn(u)}}),(0,e.jsx)(oe.Z,{visible:a.contentVisible,actionReload:function(){return nn()},onCancel:function(){return d({contentVisible:!1})},current:!1,folderItems:null,action:"add"}),(0,e.jsx)(L.Z,{visible:a.attachmentVisible,onCancel:function(){return d({attachmentVisible:!1})},current:!1,actionReload:function(){return rn()}}),(0,e.jsx)(pe.Z,{visible:a.previewVisible,onCancel:function(){return d({previewVisible:!1})},taskValues:{cids:a.cids,contentsIds:a.contentsIds}})]})};ce.Z=Pe},43522:function(ye,ce,n){var _e=n(30279),O=n.n(_e),me=n(46686),l=n.n(me),Ee=n(85170),E=n(13590),he=n(33285),M=n(58110),j=n(1166),x=n(88665),V=n(22196),y=n(13949),f=n(43010),R=function(_){var I=_.visible,ie=_.onCancel,D=_.taskValues,$=(0,j.Z)({email:"",subject:"",html:""}),T=l()($,2),p=T[0],q=T[1],H=(0,V.useRequest)(y.dS,{manual:!0,onSuccess:function(g){var ne=g.email,v=g.subject,P=g.html;console.log(ne,v,P),q({email:ne,subject:v,html:P})}}),se=H.run,te=H.loading,s=function(){var g=D.cids,ne=D.contentsIds,v=(0,x.M2)(g),P=(0,x.M2)(ne);se({cid:v,contentsId:P})};(0,Ee.useEffect)(function(){I&&s()},[I]);var ae=function(){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(E.Z,{column:1,children:[(0,f.jsx)(E.Z.Item,{label:"\u6536\u4EF6\u4EBA",children:p.email}),(0,f.jsx)(E.Z.Item,{label:"\u90AE\u4EF6\u4E3B\u9898",children:p.subject})]}),(0,f.jsx)(he.Z,{children:(0,f.jsx)("div",{style:{maxWidth:600,maxHeight:480,overflow:"auto"},dangerouslySetInnerHTML:{__html:p.html}})})]})},B={okText:"\u66F4\u6362\u9884\u89C8",onOk:s,onCancel:ie};return(0,f.jsx)(M.Z,O()(O()({title:"\u90AE\u4EF6\u9884\u89C8",width:800,destroyOnClose:!0,open:I,confirmLoading:te},B),{},{children:ae()}))};ce.Z=R},70176:function(ye,ce,n){var _e=n(30279),O=n.n(_e),me=n(35290),l=n.n(me),Ee=n(411),E=n.n(Ee),he=n(46686),M=n.n(he),j=n(85170),x=n(31810),V=n(1406),y=n(58110),f=n(1166),R=n(74637),Z=n.n(R),_=n(43010),I=function(D){var $=x.Z.useForm(),T=M()($,1),p=T[0],q=D.visible,H=D.onCancel,se=D.sendAction,te=(0,f.Z)({submitLoading:!1,showTime:""}),s=M()(te,2),ae=s[0],B=s[1],ee=function(){var P=E()(l()().mark(function U(){var le,F;return l()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(p){W.next=2;break}return W.abrupt("return");case 2:return W.prev=2,p.submit(),W.next=6,p.validateFields();case 6:le=W.sent,F=le.timeStart,B({submitLoading:!0}),se(Z()(F).valueOf()),W.next=15;break;case 12:W.prev=12,W.t0=W.catch(2),console.log("Failed:",W.t0);case 15:case"end":return W.stop()}},U,null,[[2,12]])}));return function(){return P.apply(this,arguments)}}(),g=function(U){var le=U.timeStart,F=Z()(le).format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss");B({showTime:F})};(0,j.useEffect)(function(){if(p&&q){var P=Z()(),U=P.format("YYYY\u5E74MM\u6708DD\u65E5 HH:mm:ss");p.setFieldsValue({timeStart:P}),B({showTime:U,submitLoading:!1})}},[q]);var ne=function(){return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(x.Z,{layout:"vertical",form:p,onValuesChange:g,size:"large",children:[(0,_.jsx)(x.Z.Item,{name:"timeStart",label:"\u9009\u62E9\u5B9A\u65F6\u53D1\u9001\u7684\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B9A\u65F6\u65F6\u95F4"}],children:(0,_.jsx)(V.Z,{format:"YYYY-MM-DD HH:mm:ss",showTime:{defaultValue:Z()("00:00:00","HH:mm:ss")},style:{width:"100%"},placeholder:"\u8BF7\u8BBE\u7F6E\u5B9A\u65F6\u65F6\u95F4"})}),(0,_.jsxs)("div",{style:{color:"#798699"},children:["\u672C\u90AE\u4EF6\u5C06\u5728 ",(0,_.jsx)("span",{style:{color:"#000",fontWeight:"bold"},children:ae.showTime})," ","\u5F00\u59CB\u53D1\u9001"]})]})})},v={okText:"\u53D1\u9001",onOk:ee,onCancel:H};return(0,_.jsx)(y.Z,O()(O()({title:"\u5B9A\u65F6\u53D1\u9001",width:420,bodyStyle:{padding:"20px 28px"},destroyOnClose:!0,open:q,confirmLoading:ae.submitLoading},v),{},{children:ne()}))};ce.Z=I}}]);
