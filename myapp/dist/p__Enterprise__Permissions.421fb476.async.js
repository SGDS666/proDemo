"use strict";(self.webpackChunklaifaxin_web=self.webpackChunklaifaxin_web||[]).push([[8362],{83655:function(X,g,e){var D=e(75782),l=e(85170),C=e(62658),u=e(70325),m=function(p,h){return l.createElement(u.Z,(0,D.Z)((0,D.Z)({},p),{},{ref:h,icon:C.Z}))};m.displayName="EditOutlined",g.Z=l.forwardRef(m)},50085:function(X,g,e){e.d(g,{Z:function(){return p}});var D=e(75782),l=e(85170),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},u=C,m=e(70325),d=function(R,x){return l.createElement(m.Z,(0,D.Z)((0,D.Z)({},R),{},{ref:x,icon:u}))};d.displayName="UserOutlined";var p=l.forwardRef(d)},88208:function(X,g,e){var D=e(30279),l=e.n(D),C=e(85170),u=e(91522),m=e(43010);g.Z=function(d){var p=d.children,h=d.pageTitle;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(u._z,l()(l()({header:{title:h,breadcrumb:{}}},d),{},{children:p}))})}},56314:function(X,g,e){var D=e(85170),l=e(80661),C=e(22196),u=e(43010);g.Z=function(m){var d=m.children,p=m.accessKey,h=(0,C.useModel)("@@initialState"),R=h.initialState;if(!R)return(0,u.jsx)(l.Z,{size:"large",children:"\u672A\u767B\u5F55"});var x=R.userPermissions,B=R.currentUser,K=function(){var v,H=B!=null?B:{},L=H.uid,O=H.orgId;return!!(!O||L===O||!p||x!=null&&(v=x[p])!==null&&v!==void 0&&v.checked)};return(0,u.jsx)(C.Access,{accessible:K(),children:d})}},7653:function(X,g,e){e.r(g),e.d(g,{default:function(){return je}});var D=e(30279),l=e.n(D),C=e(35290),u=e.n(C),m=e(411),d=e.n(m),p=e(46686),h=e.n(p),R=e(41318),x=e(34833),B=e(74954),K=e(56888),Y=e(96498),v=e(46394),H=e(11484),L=e(16798),O=e(77070),j=e(85170),W=e(20423),I=e(66694),re=e(1166),z=e(22196),ie=e(88208),U=e(56314),fe=e(4451),ae=e(83655),oe=e(45850),ue=e(50085),w=e(75782),de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M112 476h160v72H112zm320 0h160v72H432zm320 0h160v72H752z"}}]},name:"dash",theme:"outlined"},ce=de,se=e(70325),te=function(f,M){return j.createElement(se.Z,(0,w.Z)((0,w.Z)({},f),{},{ref:M,icon:ce}))};te.displayName="DashOutlined";var q=j.forwardRef(te),P=e(78730),me=e(48865),A=e(31810),he=e(58110),_e=e(2800),a=e(43010),De=function(f){var M=f.visible,S=f.onCancel,ee=f.actionReload,G=A.Z.useForm(),ne=h()(G,1),k=ne[0],o=(0,z.useRequest)(I.uM,{manual:!0,onSuccess:function(F){if(!!F&&(R.ZP.success("\u521B\u5EFA\u6210\u529F"),S(),F)){var $=F.id;ee($)}}}),c=o.run,V=o.loading;return(0,a.jsx)(he.Z,{destroyOnClose:!0,title:"\u89D2\u8272\u521B\u5EFA",open:M,onCancel:function(){return S()},footer:null,children:(0,a.jsxs)(A.Z,{form:k,onFinish:function(F){return c(l()(l()({},F),{},{action:"add"}))},layout:"vertical",size:"large",style:{paddingLeft:24,paddingRight:24},initialValues:{scale:1},children:[(0,a.jsx)(A.Z.Item,{label:"\u89D2\u8272\u540D\u79F0",name:"role_name",rules:[{required:!0,message:"\u89D2\u8272\u540D\u79F0"}],children:(0,a.jsx)(_e.Z,{placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"})}),(0,a.jsx)(A.Z.Item,{children:(0,a.jsx)(L.ZP,{type:"primary",htmlType:"submit",loading:V,children:"\u65B0\u589E"})})]})})},pe=De,Ce=function(f){var M=f.visible,S=f.onCancel,ee=f.actionReload,G=f.values,ne=A.Z.useForm(),k=h()(ne,1),o=k[0],c=(0,j.useState)(""),V=h()(c,2),y=V[0],F=V[1],$=(0,z.useRequest)(I.uM,{manual:!0,onSuccess:function(){R.ZP.success("\u4FEE\u6539\u6210\u529F"),S(),ee()}}),N=$.run,J=$.loading;return(0,j.useEffect)(function(){if(M){var b=G.role_id,Q=G.role_name;F(b),o.setFieldsValue({role_id:b,role_name:Q})}},[M]),(0,a.jsx)(he.Z,{destroyOnClose:!0,title:"\u89D2\u8272\u540D\u79F0\u4FEE\u6539",open:M,onCancel:function(){return S()},footer:null,children:(0,a.jsxs)(A.Z,{form:o,onFinish:function(Q){return N(l()(l()({},Q),{},{role_id:y,action:"update"}))},layout:"vertical",size:"large",style:{paddingLeft:24,paddingRight:24},initialValues:{scale:1},children:[(0,a.jsx)(A.Z.Item,{label:"\u89D2\u8272\u540D\u79F0",name:"role_name",rules:[{required:!0,message:"\u89D2\u8272\u540D\u79F0"}],children:(0,a.jsx)(_e.Z,{placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"})}),(0,a.jsx)(A.Z.Item,{children:(0,a.jsx)(L.ZP,{type:"primary",htmlType:"submit",loading:J,children:"\u4FDD\u5B58"})})]})})},Re=Ce,xe=e(51448),Oe=function(){var f=(0,j.useRef)(),M=(0,j.useState)({}),S=h()(M,2),ee=S[0],G=S[1],ne=(0,re.Z)({createVisible:!1,updateVisible:!1,changeVisible:!1,roleId:"owner",roleName:"\u62E5\u6709\u8005",roleUsers:0,permissions:{}}),k=h()(ne,2),o=k[0],c=k[1],V=(0,z.useRequest)(I.KK),y=V.data,F=V.loading,$=(0,z.useRequest)(I.n3),N=$.data,J=$.refresh,b=(0,z.useRequest)(I.uM,{manual:!0,onSuccess:function(){R.ZP.success("\u64CD\u4F5C\u6210\u529F")}}),Q=b.run,Pe=b.loading,Ze=function(){var t=d()(u()().mark(function n(r){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,J();case 2:c({roleId:r});case 3:case"end":return i.stop()}},n)}));return function(r){return t.apply(this,arguments)}}(),Ie=function(){var n;(n=f.current)===null||n===void 0||n.reload(),J()},Me=function(){var t=d()(u()().mark(function n(){var r,s,i,_,T,Z,le,Ee,ge;return u()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return r=o.roleId,E.next=3,(0,I.O8)({roleId:r});case 3:s=E.sent,i=s.success,_=s.data,i&&c({permissions:_}),E.t0=u()().keys(N);case 7:if((E.t1=E.t0()).done){E.next=15;break}if(T=E.t1.value,Z=N[T],le=Z.role_id,Ee=Z.role_name,ge=Z.users,le!==r){E.next=13;break}return c({roleName:Ee,roleUsers:ge}),E.abrupt("break",15);case 13:E.next=7;break;case 15:case"end":return E.stop()}},n)}));return function(){return t.apply(this,arguments)}}(),ye=function(){var n=o.roleId,r=o.permissions;Q({role_id:n,permissions:r,action:"update"})},Fe=function(n){var r=n.role_id;return r==="owner"?[]:[(0,a.jsx)(U.Z,{accessKey:"enterprise.permissions.manage",children:(0,a.jsx)("a",{onClick:function(){G(n),c({changeVisible:!0})},children:"\u66F4\u6362\u89D2\u8272"},"updateRoleKey")},"update")]},Ue=[{title:"\u540D\u79F0",dataIndex:"nickname",hideInSearch:!0},{title:"\u89D2\u8272",dataIndex:"role_name"},{title:"\u90E8\u95E8",dataIndex:"teamsName",valueType:"select"},{title:"\u72B6\u6001",dataIndex:"status",valueEnum:{ok:{text:"\u6B63\u5E38",status:"Processing"},disabled:{text:"\u5DF2\u7981\u7528",status:"Error"},pending:{text:"\u5F85\u6FC0\u6D3B",status:"Default"}}},{title:"\u52A0\u5165\u65F6\u95F4",dataIndex:"create_time",valueType:"dateTime"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(n,r){return Fe(r)}}],Ae=function(n,r){var s=n.split(".")[0],i=0,_=0;for(var T in r){var Z=T.split(".")[0];if(Z===s&&Z!==T){var le=r[T].checked;le?i+=1:_+=1}}i&&_?r[s]=l()(l()({},r[s]),{},{indeterminate:!0}):r[s]=l()(l()({},r[s]),{},{indeterminate:!1}),c({permissions:r})},Se=function(n,r){var s=o.permissions;s[n]=l()(l()({},s[n]),{},{checked:r}),c({permissions:s}),Ae(n,s)},be=function(n){var r=o.permissions;return n.map(function(s){var i=s.name,_=s.key;return r[_]||(r[_]={checked:!1}),(0,a.jsx)(x.Z,{checked:r[_].checked,onChange:function(Z){return Se(_,Z.target.checked)},disabled:o.roleId==="owner",children:i},_)})},Te=function(n,r){var s=o.permissions;s[n]=l()(l()({},s[n]),{},{indeterminate:!1});for(var i in s)i&&i.indexOf(n)===0&&(s[i]=l()(l()({},s[i]),{},{checked:r}));c({permissions:s})},Be=function(n,r){var s,i,_=o.permissions;return(0,a.jsx)(x.Z,{indeterminate:(s=_[n])===null||s===void 0?void 0:s.indeterminate,checked:(i=_[n])===null||i===void 0?void 0:i.checked,onChange:function(Z){return Te(n,Z.target.checked)},disabled:o.roleId==="owner",children:r},n)},Ke=function(n){var r,s=n.key;c({roleId:s}),(r=f.current)===null||r===void 0||r.reload()},Le=function(){var t=d()(u()().mark(function n(r){return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Q({action:"delete",role_id:r});case 2:return i.next=4,J();case 4:c({roleId:"owner"});case 5:case"end":return i.stop()}},n)}));return function(r){return t.apply(this,arguments)}}();(0,j.useEffect)(function(){var t;Me(),(t=f.current)===null||t===void 0||t.reload()},[o.roleId]);var We=function(n,r){c({roleId:n,roleName:r}),c({updateVisible:!0})},ze=function(n,r){return{style:{fontSize:16},items:[{key:"changeKey",label:(0,a.jsxs)("a",{onClick:function(){return We(n,r)},children:[(0,a.jsx)(ae.Z,{})," \u4FEE\u6539"]})},{key:"deleteKey",label:(0,a.jsxs)(B.Z,{title:"\u786E\u8BA4\u5220\u9664 ".concat(r,"?"),onConfirm:function(){return Le(n)},children:[(0,a.jsx)(oe.Z,{})," \u5220\u9664"]},"delete")}]}};return(0,a.jsxs)(ie.Z,{pageTitle:!1,pageGroup:"enterprise",pageActive:"permissions",children:[(0,a.jsxs)(W.ZP,{split:"vertical",children:[(0,a.jsxs)(W.ZP,{title:(0,a.jsx)("span",{style:{paddingLeft:24},children:"\u89D2\u8272\u5217\u8868"}),colSpan:"208px",ghost:!0,headerBordered:!0,children:[(0,a.jsx)(K.Z,{mode:"inline",selectedKeys:[o.roleId],onClick:Ke,children:N==null?void 0:N.map(function(t){var n=t.role_id,r=t.role_name,s=t.users;return(0,a.jsx)(K.Z.Item,{title:r,children:(0,a.jsxs)(Y.Z,{children:[(0,a.jsxs)(v.Z,{span:21,children:[r," ",(0,a.jsx)(ue.Z,{})," ",s," "]},"roleNameKey"),["owner","admin","leader","user","none"].indexOf(n)>=0?null:(0,a.jsx)(v.Z,{span:3,className:"enterpriseRoleAction",children:(0,a.jsx)(U.Z,{accessKey:"enterprise.permissions.manage",children:(0,a.jsx)(H.Z,{menu:ze(n,r),children:(0,a.jsx)(q,{})})})},"actionKey")]})},n)})}),(0,a.jsx)("div",{style:{marginTop:24,marginLeft:24,paddingBottom:48},children:(0,a.jsx)(U.Z,{accessKey:"enterprise.permissions.manage",children:(0,a.jsxs)(L.ZP,{type:"primary",onClick:function(){return c({createVisible:!0})},children:[(0,a.jsx)(P.Z,{})," \u65B0\u589E\u89D2\u8272"]})})})]}),(0,a.jsx)(W.ZP,{loading:F,title:(0,a.jsx)("span",{style:{paddingLeft:24},children:o.roleName}),headerBordered:!0,ghost:!0,children:(0,a.jsxs)(O.Z,{defaultActiveKey:"members",style:{paddingLeft:24},children:[(0,a.jsx)(O.Z.TabPane,{tab:"\u6210\u5458\u5217\u8868",children:(0,a.jsx)(me.ZP,{headerTitle:!1,options:!1,actionRef:f,rowKey:"uid",search:!1,request:function(n,r,s){return(0,I.pr)(l()(l()({},n),{},{sorter:r,filter:s,roleId:o.roleId}))},columns:Ue,rowSelection:!1})},"members"),o.roleId==="none"?null:(0,a.jsxs)(O.Z.TabPane,{tab:"\u6743\u9650\u8303\u56F4",children:[y!=null&&y.length?y.map(function(t){var n=t.key,r=t.name,s=t.tip,i=t.children;return(0,a.jsx)(W.ZP,{title:Be(n,r),tooltip:s,bordered:!0,children:be(i)},n)}):null,(0,a.jsx)(U.Z,{accessKey:"enterprise.permissions.manage",children:o.roleId==="owner"?null:(0,a.jsx)(L.ZP,{type:"primary",style:{marginTop:24,marginBottom:24},loading:Pe,onClick:ye,children:"\u4FDD\u5B58"})})]},"permissions")]})})]}),(0,a.jsx)(pe,{visible:o.createVisible,onCancel:function(){return c({createVisible:!1})},actionReload:Ze}),(0,a.jsx)(Re,{visible:o.updateVisible,onCancel:function(){return c({updateVisible:!1})},actionReload:J,values:{role_id:o.roleId,role_name:o.roleName}}),(0,a.jsx)(xe.Z,{visible:o.changeVisible,onCancel:function(){return c({changeVisible:!1})},actionReload:Ie,values:ee})]})},je=Oe},51448:function(X,g,e){var D=e(30279),l=e.n(D),C=e(46686),u=e.n(C),m=e(85170),d=e(31810),p=e(41318),h=e(58110),R=e(2800),x=e(43520),B=e(16798),K=e(66694),Y=e(22196),v=e(43010),H=function(O){var j=O.visible,W=O.onCancel,I=O.actionReload,re=O.values,z=d.Z.useForm(),ie=u()(z,1),U=ie[0],fe=(0,m.useState)(""),ae=u()(fe,2),oe=ae[0],ue=ae[1],w=(0,Y.useRequest)(K.bB,{manual:!0,onSuccess:function(){p.ZP.success("\u64CD\u4F5C\u6210\u529F"),W(),I()}}),de=w.run,ce=w.loading,se=(0,Y.useRequest)(K.n3,{manual:!0}),te=se.run,q=se.data;return(0,m.useEffect)(function(){if(j){var P=re.userid;ue(P),U.resetFields(),U.setFieldsValue(l()({},re)),te()}},[j]),(0,v.jsx)(h.Z,{destroyOnClose:!0,title:"\u66F4\u6362\u89D2\u8272",open:j,onCancel:function(){return W()},footer:null,children:(0,v.jsxs)(d.Z,{form:U,onFinish:function(me){return de(l()(l()({},me),{},{userid:oe}))},layout:"vertical",size:"large",style:{paddingLeft:24,paddingRight:24},children:[(0,v.jsx)(d.Z.Item,{label:"\u6210\u5458\u540D\u79F0",name:"nickname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6210\u5458\u540D\u79F0"}],children:(0,v.jsx)(R.Z,{placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u540D\u79F0",disabled:!0})}),(0,v.jsx)(d.Z.Item,{label:"\u6240\u5C5E\u89D2\u8272",name:"role_id",children:(0,v.jsx)(x.Z,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},children:q==null?void 0:q.map(function(P){return P.role_id==="owner"?null:(0,v.jsx)(x.Z.Option,{value:P.role_id,children:P.role_name},P.role_id)})})}),(0,v.jsx)(d.Z.Item,{children:(0,v.jsx)(B.ZP,{type:"primary",htmlType:"submit",loading:ce,children:"\u4FDD\u5B58"})})]})})};g.Z=H},4451:function(){}}]);
